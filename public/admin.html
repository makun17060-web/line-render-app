<!-- ===== Admin Console: public/admin.html ===== -->
<div class="row"><button class="secondary" id="btnHealth">/api/health</button></div>
<pre id="healthOut" hidden></pre>
</div>
</section>


<!-- 商品 → 自動カルーセル生成（プレビュー＆配信） -->
<section class="card" id="sec-products">
<h2>商品一覧 → リッチメッセージ（Flex）自動生成</h2>
<div class="row"><button id="btnLoadProducts">/data/products.json を取得</button><span id="prodCount" class="muted"></span></div>
<div class="grid two">
<div>
<label class="muted">オプション</label>
<div class="row"><input type="text" id="hideIds" placeholder="一覧から隠すID（例: kusuke-250,foo-123）"></div>
<div class="row"><input type="text" id="altText" placeholder="altText（必須）：商品一覧"></div>
<div class="row"><button id="btnBuildFlex">Flex を生成（プレビュー）</button></div>
</div>
<div>
<label class="muted">Flex JSON プレビュー</label>
<pre id="flexPreview"></pre>
</div>
</div>
<div class="row">
<input id="userIds" type="text" placeholder="セグメント配信用 userId（カンマ区切り）。空なら broadcast" />
<button class="secondary" id="btnAutofillUsers">自動取得して差し込み</button>
</div>
<div class="row"><button id="btnSendFlex">この Flex を配信</button><span id="sendFlexRes" class="muted"></span></div>
</section>


<!-- テキスト配信（セグメント / ブロードキャスト） -->
<section class="card" id="sec-text">
<h2>テキスト配信（セグメント / ブロードキャスト）</h2>
<div class="row"><textarea id="textMessage" placeholder="配信する本文"></textarea></div>
<div class="row"><input id="textUserIds" type="text" placeholder="userId（カンマ区切り）。空なら broadcast" />
<button class="secondary" id="btnAutofillUsers2">自動取得して差し込み</button>
</div>
<div class="row">
<button id="btnSendText">送信</button>
<span id="sendTextRes" class="muted"></span>
</div>
<div class="muted">セグメント送信は /api/admin/segment/send、ブロードキャストは /v2/bot/message/broadcast を使用します。</div>
</section>


<!-- ユーザー収集 & メッセージログ -->
<section class="card" id="sec-logs">
<h2>メッセージログ（/data/messages.log の tail）</h2>
<div class="row"><button id="btnLoadLog">最新200件を取得</button><button class="secondary" id="btnAutoRefresh">10秒ごと更新</button><span id="autoStatus" class="pill">OFF</span></div>
<pre id="logOut" hidden></pre>
<div class="muted">この画面は /api/admin/messages を叩いており、サーバー側で tail 相当を返しています。</div>
</section>
</main>


<!-- 外部JS -->
<script src="./admin.js"></script>
</body>
</html>
