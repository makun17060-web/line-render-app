<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>ご利用方法（初めての方へ）</title>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <style>
    :root{
      --bg:#f7f7f7; --card:#fff; --text:#1f2937; --muted:#6b7280;
      --primary:#0b3a53; --accent:#7a1f1f; --border:#e5e7eb;
      --radius:14px;
    }
    body{ margin:0; font-family: system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif; background:var(--bg); color:var(--text); }
    .wrap{ max-width:720px; margin:0 auto; padding:14px 14px 28px; }
    .topbar{ display:flex; gap:10px; align-items:center; justify-content:space-between; margin-bottom:10px; }
    .badge{ font-size:12px; color:var(--muted); }
    h1{ font-size:20px; margin:6px 0 2px; }
    .lead{ font-size:14px; color:var(--muted); line-height:1.7; margin:0 0 10px; }
    .card{ background:var(--card); border:1px solid var(--border); border-radius:var(--radius); padding:12px; margin:10px 0; box-shadow:0 1px 3px rgba(0,0,0,.05); }
    .step{ display:flex; gap:10px; align-items:flex-start; }
    .num{ min-width:34px; height:34px; border-radius:10px; background:#eef2ff; color:var(--primary); display:flex; align-items:center; justify-content:center; font-weight:800; }
    .stitle{ font-weight:800; margin:0 0 3px; font-size:16px; }
    .sdesc{ margin:0; color:var(--muted); font-size:14px; line-height:1.7; }
    .actions{ display:grid; grid-template-columns:1fr; gap:10px; margin-top:12px; }
    .btn{ border:0; border-radius:14px; padding:13px 14px; font-size:16px; font-weight:800; cursor:pointer; }
    .btn.primary{ background:var(--primary); color:#fff; }
    .btn.accent{ background:var(--accent); color:#fff; }
    .btn.ghost{ background:#fff; color:var(--text); border:1px solid var(--border); }
    .note{ font-size:13px; color:var(--muted); line-height:1.7; }
    .hr{ height:1px; background:var(--border); margin:12px 0; }
    .small{ font-size:12px; color:var(--muted); }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="topbar">
      <div>
        <div class="badge" id="envBadge">LIFF</div>
        <h1>ご利用方法（初めての方へ）</h1>
        <p class="lead">LINE上で完結します。履歴が残るので、聞き間違いがなく安心です。</p>
      </div>
      <button class="btn ghost" id="btnClose" style="padding:10px 12px; font-size:14px;">閉じる</button>
    </div>

    <div class="card">
      <div class="step">
        <div class="num">1</div>
        <div>
          <p class="stitle">商品を選ぶ</p>
          <p class="sdesc">「商品一覧」または「ご注文はこちら」から、商品と数量をお選びください。</p>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="step">
        <div class="num">2</div>
        <div>
          <p class="stitle">お届け先を入力</p>
          <p class="sdesc">初めての方は住所登録をお願いします。2回目以降は自動で表示されます。</p>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="step">
        <div class="num">3</div>
        <div>
          <p class="stitle">お支払い</p>
          <p class="sdesc">画面に表示されるお支払い方法からお選びください。（例：クレジット／代引き など）</p>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="step">
        <div class="num">4</div>
        <div>
          <p class="stitle">発送・お届け</p>
          <p class="sdesc">発送準備が整い次第、LINEでお知らせします。到着目安や送料は「配送・送料」をご確認ください。</p>
        </div>
      </div>

      <div class="hr"></div>

      <p class="stitle" style="margin:0 0 6px;">操作がご不安な方へ</p>
      <p class="note" style="margin:0;">
        ご家族の方による<strong>代理注文</strong>も可能です。<br/>
        お届け先をご本人様に指定していただければ、そのまま発送いたします。
      </p>
    </div>

    <div class="card">
      <p class="stitle" style="margin:0 0 8px;">すぐに進む</p>
      <div class="actions">
        <button class="btn primary" id="btnOrder">ご注文はこちら</button>
        <button class="btn ghost" id="btnAddress">住所登録／変更</button>
        <button class="btn ghost" id="btnShipping">配送・送料</button>
        <button class="btn accent" id="btnChat">お問い合わせ（LINE）</button>
      </div>
      <p class="small" style="margin:10px 0 0;">※ LINEアプリ内で開くと、ボタンがよりスムーズに動作します。</p>
    </div>
  </div>

  <script>
    // ★ここだけあなたの環境に合わせて差し替え
    const LINKS = {
      ORDER_URL:   "https://line-render-app-1.onrender.com/public/products.html",     // 注文（LIFF or Web）
      ADDRESS_URL: "https://liff.line.me/2008406620-4kyQVyqe// 住所登録LIFF
      SHIPPING_URL:"https://YOUR_DOMAIN/shipping",       // 送料ページ（Web）
      CHAT_TEXT:   "お問い合わせです。",                 // トークに入れたい初期文言（任意）
    };

    function openUrl(url, external=false){
      if (window.liff && liff.isInClient()){
        liff.openWindow({ url, external }); // external=false ならLINE内で開く
      }else{
        window.location.href = url;
      }
    }

    async function init(){
      // LIFF ID を使う構成の場合は下を有効化（同一ドメインで動かしているなら不要なことも多い）
      // await liff.init({ liffId: "YOUR_LIFF_ID" });

      const inClient = (window.liff && liff.isInClient && liff.isInClient());
      document.getElementById("envBadge").textContent = inClient ? "LINEアプリ内（LIFF）" : "ブラウザ表示";

      document.getElementById("btnClose").onclick = () => {
        if (inClient) liff.closeWindow();
        else history.back();
      };

      document.getElementById("btnOrder").onclick   = () => openUrl(LINKS.ORDER_URL, false);
      document.getElementById("btnAddress").onclick = () => openUrl(LINKS.ADDRESS_URL, false);
      document.getElementById("btnShipping").onclick= () => openUrl(LINKS.SHIPPING_URL, true);

      document.getElementById("btnChat").onclick = () => {
        // LIFF内ならトークへ誘導（文言を入れたい場合は sendMessages）
        if (inClient){
          // sendMessages を使う場合：ユーザー操作が必要（ボタン押下OK）
          liff.sendMessages([{ type:"text", text: LINKS.CHAT_TEXT }]).then(() => liff.closeWindow());
        }else{
          alert("LINEアプリ内で開くと、そのままお問い合わせできます。");
        }
      };
    }

    // liff未初期化でも動くように（外部ブラウザ対策）
    (async()=>{ try{ await init(); }catch(e){ console.log(e); await init(); } })();
  </script>
</body>
</html>
