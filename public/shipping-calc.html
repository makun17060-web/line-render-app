<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>お支払い総額の目安（梱包・発送込み）</title>

<style>
  body { font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; background:#f7f7f7; margin:0; padding:16px; color:#333; }
  .wrap { max-width:720px; margin:0 auto; }

  /* ===== 上部バー（戻る） ===== */
  .topbar { display:flex; justify-content:flex-end; margin-bottom:8px; }
  .closeBtn{
    width:auto;
    padding:10px 12px;
    font-size:14px;
    border:1px solid #ddd;
    background:#fff;
    color:#0b3a53;
    border-radius:10px;
    font-weight:700;
    cursor:pointer;
  }
  .closeBtn:active{ transform: translateY(1px); }

  h1 { font-size:20px; margin:0 0 8px; }
  .lead { font-size:13px; color:#555; line-height:1.7; margin:0 0 12px; }
  .card { background:#fff; border-radius:12px; padding:14px; margin-bottom:12px; box-shadow:0 1px 3px rgba(0,0,0,.08); }
  label { font-size:14px; font-weight:700; display:block; margin-bottom:4px; }
  select, input { width:100%; padding:10px; font-size:15px; border-radius:8px; border:1px solid #ccc; }
  button.main { width:100%; padding:12px; font-size:16px; border:0; border-radius:10px; background:#0b3a53; color:#fff; font-weight:700; cursor:pointer; }
  .result { font-size:15px; line-height:1.75; }
  .result .big { font-size:18px; font-weight:800; }
  .note { font-size:13px; color:#666; line-height:1.7; }
  .muted { color:#777; font-size:12px; }
  .hr { height:1px; background:#eee; margin:10px 0; }
</style>
</head>

<body>
<div class="wrap">

  <!-- 「閉じる」＝前の画面へ戻る（ご利用方法に戻る想定） -->
  <div class="topbar">
    <button class="closeBtn" type="button" onclick="goBack()">戻る</button>
  </div>

  <h1>お支払い総額の目安</h1>
  <p class="lead">
    このページは「梱包・発送費用を含めた総額の目安」を確認できます。<br>
    最終的な金額は、注文画面の<strong>最終確認</strong>で確定します。
  </p>

  <div class="card">
    <label>お届け先（都道府県）</label>
    <select id="pref">
      <option value="">選択してください</option>
      <option>北海道</option>
      <option>青森県</option><option>岩手県</option><option>宮城県</option><option>秋田県</option><option>山形県</option><option>福島県</option>
      <option>茨城県</option><option>栃木県</option><option>群馬県</option><option>埼玉県</option><option>千葉県</option><option>東京都</option><option>神奈川県</option>
      <option>新潟県</option><option>富山県</option><option>石川県</option><option>福井県</option><option>長野県</option>
      <option>岐阜県</option><option>静岡県</option><option>愛知県</option><option>三重県</option>
      <option>滋賀県</option><option>京都府</option><option>大阪府</option><option>兵庫県</option><option>奈良県</option><option>和歌山県</option>
      <option>鳥取県</option><option>島根県</option><option>岡山県</option><option>広島県</option><option>山口県</option>
      <option>徳島県</option><option>香川県</option><option>愛媛県</option><option>高知県</option>
      <option>福岡県</option><option>佐賀県</option><option>長崎県</option><option>熊本県</option><option>大分県</option><option>宮崎県</option><option>鹿児島県</option>
      <option>沖縄県</option>
    </select>
  </div>

  <div class="card">
    <label>商品種別</label>
    <select id="productType">
      <option value="akasha">あかしゃシリーズ</option>
      <option value="original">磯屋オリジナルセット</option>
    </select>
    <div class="muted" style="margin-top:6px;">
      ※久助や他商品を含む場合は、注文画面の最終確認をご利用ください
    </div>
  </div>

  <div class="card">
    <label id="qtyLabel">あかしゃシリーズ 合計袋数</label>
    <input type="number" id="qty" min="1" max="99" placeholder="例：6" />
  </div>

  <div class="card">
    <button class="main" onclick="calc()">総額の目安を見る</button>
  </div>

  <div class="card">
    <div id="result" class="result">―</div>
  </div>

  <div class="card note" id="noteBox"></div>

</div>

<script>
/* 戻る（closeWindowは使わない） */
function goBack() {
  // 前の画面（ご利用方法）に戻す。戻れない場合は何もしない（勝手に閉じない）
  if (history.length > 1) history.back();
}

/* ヤマト 中部発 送料（税込） */
const YAMATO_CHUBU_TAXED = {
  "60":  { 北海道:1610, 東北:1190, 関東: 940, 中部: 940, 近畿: 940, 中国:1060, 四国:1060, 九州:1190, 沖縄:1460 },
  "80":  { 北海道:1900, 東北:1480, 関東:1230, 中部:1230, 近畿:1230, 中国:1350, 四国:1350, 九州:1480, 沖縄:2070 },
  "100": { 北海道:2200, 東北:1790, 関東:1530, 中部:1530, 近畿:1530, 中国:1650, 四国:1650, 九州:1790, 沖縄:2710 },
  "120": { 北海道:2780, 東北:2310, 関東:2040, 中部:2040, 近畿:2040, 中国:2170, 四国:2170, 九州:2310, 沖縄:3360 },
  "140": { 北海道:3440, 東北:2930, 関東:2630, 中部:2630, 近畿:2630, 中国:2780, 四国:2780, 九州:2930, 沖縄:4030 },
  "160": { 北海道:3820, 東北:3320, 関東:3020, 中部:3020, 近畿:3020, 中国:3160, 四国:3160, 九州:3320, 沖縄:4680 }
};

/* 概算の商品価格（調整OK） */
const PRICE = {
  AKASHA_PER_BAG: 340,
  ORIGINAL_SET_PER: 2000
};

function detectRegion(pref) {
  if (/北海道/.test(pref)) return "北海道";
  if (/(青森|岩手|宮城|秋田|山形|福島)/.test(pref)) return "東北";
  if (/(茨城|栃木|群馬|埼玉|千葉|東京|神奈川)/.test(pref)) return "関東";
  if (/(新潟|富山|石川|福井|長野|岐阜|静岡|愛知|三重)/.test(pref)) return "中部";
  if (/(滋賀|京都|大阪|兵庫|奈良|和歌山)/.test(pref)) return "近畿";
  if (/(鳥取|島根|岡山|広島|山口)/.test(pref)) return "中国";
  if (/(徳島|香川|愛媛|高知)/.test(pref)) return "四国";
  if (/(福岡|佐賀|長崎|熊本|大分|宮崎|鹿児島)/.test(pref)) return "九州";
  if (/沖縄/.test(pref)) return "沖縄";
  return "";
}

/* 袋数 → サイズ（あかしゃ） */
function sizeFromAkashaQty(q) {
  if (q <= 4) return "60";
  if (q <= 8) return "80";
  if (q <= 13) return "100";
  if (q <= 18) return "120";
  return "140";
}

/* 個数 → サイズ（オリジナルセット） */
function sizeFromOriginalSetQty(q) {
  if (q === 1) return "80";
  if (q === 2) return "100";
  if (q <= 4) return "120";
  if (q <= 6) return "140";
  return "160";
}

function yen(n) { return Number(n || 0).toLocaleString("ja-JP") + "円"; }

/* UI切替 */
function updateUiByType() {
  const type = document.getElementById("productType").value;
  const label = document.getElementById("qtyLabel");
  const note = document.getElementById("noteBox");

  if (type === "original") {
    label.textContent = "磯屋オリジナルセット 個数";
    note.innerHTML =
      "対象商品：磯屋オリジナルセット<br>" +
      "※ 個数でサイズ判定します（1⇒80 / 2⇒100 / 3-4⇒120 / 5-6⇒140 / 7+⇒160）。";
  } else {
    label.textContent = "あかしゃシリーズ 合計袋数";
    note.innerHTML =
      "対象商品：のりあかしゃ／うずあかしゃ／潮あかしゃ／ごまあかしゃ／いそあかしゃ／松あかしゃ<br>" +
      "※ あかしゃシリーズのみ対象です（他商品は含まれません）。";
  }
}

/* 計算 */
function calc() {
  const pref = document.getElementById("pref").value;
  const qty  = Number(document.getElementById("qty").value);
  const type = document.getElementById("productType").value;

  if (!pref || !qty) {
    document.getElementById("result").textContent = "都道府県と数量を入力してください。";
    return;
  }

  const region = detectRegion(pref);

  let size = "";
  let itemTotal = 0;

  if (type === "original") {
    size = sizeFromOriginalSetQty(qty);
    itemTotal = qty * PRICE.ORIGINAL_SET_PER;
  } else {
    size = sizeFromAkashaQty(qty);
    itemTotal = qty * PRICE.AKASHA_PER_BAG;
  }

  const ship = YAMATO_CHUBU_TAXED[size]?.[region] || 0;
  const total = itemTotal + ship;

  document.getElementById("result").innerHTML =
    `商品：<b>${type === "original" ? "磯屋オリジナルセット" : "あかしゃシリーズ"}</b><br>` +
    `お届け先：<b>${region}</b> ／ サイズ目安：<b>${size}</b><br>` +
    `<div class="hr"></div>` +
    `商品代（目安）：<b>${yen(itemTotal)}</b><br>` +
    `梱包・発送費用（目安）：<b>${yen(ship)}</b><br>` +
    `<div class="hr"></div>` +
    `<div class="big">総額の目安：${yen(total)}</div>` +
    `<div class="muted">※最終的な金額は注文画面の最終確認で確定します</div>`;
}

document.getElementById("productType").addEventListener("change", updateUiByType);
updateUiByType();
</script>
</body>
</html>
